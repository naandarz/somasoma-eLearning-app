{% extends 'base.html' %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block app_content %}
<!-- Flash message -->
<div class="row">
    <div class="col-sm-12">
        {% include '_flash_message.html' %}
    </div>
</div>
<!-- End of flash message -->
<div class="row">

    <!-- Start of sidebar -->
    <div class="col-sm-2 sidebar">
        <div class="mini-submenu">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </div>
        <div class="list-group">
            <a href="#" class="list-group-item tablinks" onclick="openCity(event, 'account')" id="defaultOpen">
                Admin Account
            </a>
            <a href="#" class="list-group-item tablinks" onclick="openCity(event, 'students')">
                All Students
            </a>
            <a href="#" class="list-group-item tablinks" onclick="openCity(event, 'teachers')">
                All Teachers
            </a>
            <a href="#" class="list-group-item tablinks" onclick="openCity(event, 'parents')">
                All Parents
            </a>
        </div>   
    </div>
    <!-- End of sidebar -->
    
    <!-- Start of tab contents -->
    <div class="col-sm-10 ">

        <!-- ADMIN ACCOUNT TAB -->
        <div id="account" class="tabcontent">
            <div class="row">
                <div class="row">
                    <div class="col-sm-12">
                        <h1>Admin Account</h1>
                    </div>
                </div>
                <div class="row profile">
                    <div class="col-sm-12">
                        <h2>Profile</h2>
                        <div class="row">
                            <div class="col-sm-3">
                                <img src=" {{ current_user.avatar_admin(128) }} ">
                            </div>
                            <div class="col-sm-9">
                                <p>
                                    Your Full Name: <span style="font-weight: 600;">{{ current_user.admin_full_name }}</span> 
                                </p>
                                <p>
                                    Email: <span style="font-weight: 600;">{{ current_user.admin_email }}</span> 
                                </p>
                                <p>
                                    Phone: <span style="font-weight: 600;">{{ current_user.admin_phone }}</span> 
                                </p>
                                {% if current_user.admin_about_me %}
                                    <p>
                                        About me: <span style="font-weight: 600;">{{ current_user.admin_about_me }}</span>
                                    </p>
                                {% endif %}
                                {% if current_user.admin_last_seen %}
                                    <p>
                                        Last seen on: <span style="font-weight: 600;">{{ moment(current_user.admin_last_seen).format('LLL') }}</span>
                                    </p>
                                {% endif %}                           
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row update-account">
                    <div class="col-sm-12">
                        <h2>Update Account Details</h2>
                        <div class="col-sm-12">
                            <p>
                                Update your admin bio information <br>                            
                            </p>
                            <p>
                                <a href=" {{ url_for('admin.edit_profile_admin') }} " class="btn btn-primary">Update Bio</a>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row two-factor-auth">
                    <div class="col-sm-12">
                        <h2>Two-Factor Authentication</h2>
                        <p>
                            Add an extra layer of security to your account by enabling two-factor authentication.
                        </p>
                        {% if not current_user.two_factor_admin_enabled() %}
                            <p>
                                <a href=" {{ url_for('auth.enable_2fa_admin', admin_full_name=admin.admin_full_name) }} " class="btn btn-primary">Enable Two-Factor Authentication</a>
                            </p>
                        {% else %}
                            <p>
                                <a href=" {{ url_for('auth.disable_2fa_admin', admin_full_name=admin.admin_full_name) }} " class="btn btn-primary">Disable Two-Factor Authentication</a>
                            </p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- END OF ADMIN ACCOUNT TAB -->

        <!-- ALL STUDENTS TAB -->
        <div id="students" class="tabcontent">
            <div class="row">
                <h1>All Students ({{ all_students }})</h1>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Age</th>
                                <th>School</th>
                                <th>Course</th>
                                <th>Last Seen On</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in students %}
                                <tr>
                                    <td>{{ student.id }}</td>
                                    <td>{{ student.student_full_name }}</td>
                                    <td>{{ student.student_email }}</td>
                                    <td>{{ student.student_phone }}</td>
                                    <td>{{ student.student_age }}</td>
                                    <td>{{ student.student_school }}</td>
                                    <td>{{ student.student_course }}</td>
                                    <td>{{ moment(student.student_last_seen).format('LLL') }}</td>
                                    <td>
                                        <span class="label label-danger">
                                            <a href="{{ url_for('admin.delete_account_student', student_id=student.id) }}">Delete</a>
                                        </span>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- END ALL STUDENTS TAB -->

        <!-- ALL TEACHERS TAB -->
        <div id="teachers" class="tabcontent">
            <div class="row">
                <div class="col-sm-12">
                    <h1>All Teachers ({{ all_teachers }})</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Residence</th>
                                <th>Course</th>
                                <th>Last Seen On</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for teacher in teachers %}
                                <tr>
                                    <td>{{ teacher.id }}</td>
                                    <td>{{ teacher.teacher_full_name }}</td>
                                    <td>{{ teacher.teacher_email }}</td>
                                    <td>{{ teacher.teacher_phone }}</td>
                                    <td>{{ teacher.teacher_residence }}</td>
                                    <td>{{ teacher.teacher_course }}</td>
                                    <td>{{ moment(teacher.teacher_last_seen).format('LLL') }}</td>
                                    <td>
                                        <span class="label label-danger">
                                            <a href="{{ url_for('admin.delete_account_teacher', teacher_id=teacher.id) }}">Delete</a>
                                        </span>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- END OF ALL TEACHERS TAB -->

        <!-- ALL PARENTS TAB -->
        <div id="parents" class="tabcontent">
            <div class="row">
                <div class="col-sm-12">
                    <h1>All Parents ({{ all_parents }})</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Occupation</th>
                                <th>Residence</th>
                                <th>Last Seen On</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for parent in parents %}
                                <tr>
                                    <td>{{ parent.id }}</td>
                                    <td>{{ parent.parent_full_name }}</td>
                                    <td>{{ parent.parent_email }}</td>
                                    <td>{{ parent.parent_phone }}</td>
                                    <td>{{ parent.parent_occupation }}</td>
                                    <td>{{ parent.parent_residence }}</td>
                                    <td>{{ moment(parent.parent_last_seen).format('LLL') }}</td>
                                    <td>
                                        <span class="label label-danger">
                                            <a href="{{ url_for('admin.delete_account_parent', parent_id=parent.id) }}">Delete</a>
                                        </span>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- END OF ALL PARENTS TAB -->

    </div>
    <!-- End of tab contents -->

</div>
{% endblock %}